# 04 콜백함수

> 다른 코드의 인자로 넘겨주는 함수. 필요에 따라 넘겨받은 후 적절한 시점에 시행되며 제어권과 연관이 있다. 어떤 이벤트가 발생한 후, 수행될 함수를 의미

## 4-1 콜백함수란?

**CallBack**

= 함수 X를 호출하면서 특정 조건일 때 함수 Y를 실행해서 나에게 알려달라고 명령하는 것 -> 함수 X는 해당 조건이 갖춰졌는지 여부를 스스로 판단하고 Y를 직접 호출한다.

## 4-2 제어권

### 4-2-1 호출 시점

```javascript
var count = 0;
var timer = setInterval(function(){
    console.log(count);
    if(++count > 4) clearInterval(timer);
}, 300);
```

setInterval의 구조

```javascript
var intervalID = scope.setInterval(func, delay [, param1, param2, ...]);
```

scope: Window 객체나 Worker의 인스턴스가 들어온다

func, delay: 값 전달 필수. 세 번째 매개변수([] 안의 것들) 부터는 선택

delay: 밀리초(ms) 단위의 숫자. 매 ms 마다 func에 넘겨준 함수가 실행

param1, param2, ..: func 함수 실행 시 매개변수로 전달할 인자

setInterval을 실행하면 반복적으로 **실행되는 내용 자체를 특정할 수 있는 고유한 ID 값이 반환**된다.

setInterval 함수는 리턴 값 없이 매개변수 안에 있는 실행구문을 실행시켜주고 끝이 아니라, 코드 내 유일한 timer id를 int 형태로 반환한다. (timer id 값은 clearInterval 함수로 타이머 함수를 종료시킬 때도 사용가능한 유니크한 키 값)

```javascript
var count = 0;
var cbFunc = function(){
    console.log(count);
    if(++count > 4) clearInterval(timer);
};
var timer = setInterval(cbFunc, 300);
```

timer 변수에는 setInterval의 ID 값이 담긴다. setInterval에 전달한 첫 번째 인자 cbFunc 콜백함수는 0.3초마다 자동 실행된다. 콜백 함수 내부에서 count 값을 출력하고, 1 증가시킨 뒤 그 값이 4보다 크면 반복실행을 종료한다.

| code                      | 호출주체    | 제어권      |
| ------------------------- | ----------- | ----------- |
| cbFunc();                 | 사용자      | 사용자      |
| setInterval(cbFunc, 300); | setInterval | setInterval |

=> 콜백 함수의 제어권을 넘겨받은 코드는 콜백함수 호출 시점에 대한 제어권을 가짐

### 4-2-2 인자

```javascript
var newArr = [10, 20, 30].map(function(currentValue, index) {
    console.log(currentValue, index);
    return currentValue + 5;
});
console.log(newArr);
```

map 메서드의 구조

```javascript
Array.prototype.map(callback[, thisArg]);
callback: function(currentValue, index, array)
```

첫 번째 인자로 callback 함수를 받고, 생략 가능한 두 번째 인자로 콜백함수 내부에서 this로 인식할 대상을 특정할 수 있다. 생략할 경우 일반 함수처럼 전역객체가 바인딩된다.

map 메서드는 메서드의 대상이 되는 배열의 모든 요소들을 처음부터 끝까지 하나씩 꺼내 **콜백 함수를 반복 호출하고, 콜백 함수의 실행 결과들을 모아 새 배열을 만든다.**

콜백함수의 인자에는 순서대로 **배열의 요소 중 현재값, 현재값의 인덱스, map 메서드의 대상이 되는 배열 자체**가 담긴다. 콜백함수의 제어권을 넘겨받은 코드는 콜백함수를 호출할 때 인자에 어떤 값들을 순서로 넘길 것인지에 대한 제어권을 가진다.

### 4-2-3 this



## 4-3 콜백함수는 함수다

## 4-4 콜백 함수 내부의 this에 다른 값 바인딩하기

## 4-5 콜백 지옥과 비동기 제어

## 4-6 정리