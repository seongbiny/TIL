# webRTC

webRTC(Web Real-Time Communication)는 웹 어플리케이션과 사이트가 중간자 없이 브라우저 간 오디오나 영상 미디어를 포착하고, 자유로운 스트림과 더불어 임의의 데이터 교환 기능도 제공한다. 주로 화상 컨퍼런스, 파일 공유, 화면 공유, 방송 등에 쓰인다. 

**드라이버나 플러그인 설치 없이 웹 브라우저 간 P2P 연결을 통해 데이터 교환을 가능하게 하는 기술**이다.

## 1) 참고자료

|           내용            |                           참고링크                           |
| :-----------------------: | :----------------------------------------------------------: |
|        WebRTC API         |   https://developer.mozilla.org/ko/docs/Web/API/WebRTC_API   |
| WebRTC 실시간 데이터 교환 | https://wormwlrm.github.io/2021/01/24/Introducing-WebRTC.html |
| WebRTC (STUN, TURN 서버)  |              https://andonekwon.tistory.com/59               |

#### WebRTC가 실시간으로 웹에서 데이터를 교환할 수 있는 이유는 **시그널링이라고 일컫어지는 NAT 우회 과정을 거치기 때문이다.**

=> 각각의 기기가 서버 도움 없이 연결되기 위해 이 연결을 도와주는 서버(Signaling)가 필요하고 P2P 연결이 불가능한 상황을 대비한 릴레이 서버(TURN)가 필요하다.

### WebRTC 활용 분야

* 1:1 방식 서비스
* 1:N 방송 서비스
* N:N 회의형 서비스

![7](C:\Users\SSAFY\Desktop\image\7.png)

#### 1:1 방식 서비스

WebRTC가 제공하는 P2P 기능을 기반으로 하는 서비스로, 기존의 VoIP 기술이나 전화 서비스등을 대체할 수 있다. WebRTC는 이미 우리가 접하는 수많은 통화 앱(카카오톡 보이스톡 등)에서 사용되어 왔다. 또한 전화 영어나 심리 및 의료상담 등에서도 WebRTC를 활용하고 있다.

#### 1:N 방송 서비스

기존 방송 기술의 지연시간은 보통 5~20초로, 3초 아래의 지연시간을 보장하기 어렵다. WebRTC는 낮은 지연시간을 필요로하는 생방송 서비스에서 인기를 끌고있다. 특히 라이브 커머스, 라이브 옥션, 라이브 퀴즈, 웨비나 등 시청자와 활발한 소통이 필요한 분야에서 필수 기술로 자리 잡고 있다.

#### N:N 회의형 서비스

WebRTC를 이용한 화상회의 서비스는 COVID-19 시대에 신이 내린 선물이다. 단지 비즈니스나 교육을 위해서만 WebRTC N:N 기술이 사용되지는 않는다. 이미 수많은 N:N 회의형 킬러 서비스들을 알고있는데, 이들은 모두 WebRTC 기술을 활용하고 있다.

### WebRTC 기술의 어려움

#### 1. 네트워크 환경에 따른 품질의 불확실성

웹 환경에서 살고 있는 우리는 매우 신뢰도가 높은 프로토콜인 TCP 기반의 서비스를 주로 경험하고 있기 때문에 네트워크가 얼마나 극도로 예민한지 잊어버리곤 한다. WebRTC는 UDP 기반의 RTP 프로토콜을 사용하고 있다. 품질을 보정하는 기술이 내장되어 있지만, 네트워크 기술에 대한 이해와 충분한 개발 경험이 없다면 WebRTC 기반의 서비스 개발에 성공했다고 안정적인 품질을 보장할 수 없다는 것을 곧 깨닫게 될 것이다.

#### 2. 고난이도의 미디어처리 영역

1:1 통화 서비스가 아닌 화상회의나 방송 서비스를 개발하려면 다양한 미디어 처리를 위한 서버들이 필요하다. 보통의 WebRTC 기반 라이브 스트리밍 서비스에서 필요로 하는 미디어 처리 흐름은 그림과 같다.

![image-20220114190425543](C:\Users\SSAFY\AppData\Roaming\Typora\typora-user-images\image-20220114190425543.png)

'송출'에서 'Origin'에 이르는 부분과 'Edge'에서 '수신'에 이르는 과정만이 WebRTC가 관여하는 부분이고 나머지는 모두 각자의 플랫폼과 각자의 방식으로 구현하거나 감안해야 하는 영역이다.

#### 3. 대용량 처리 및 클라우드

WebRTC 미디어 서버는 WebRTC 기반의 미디어 스트림을 중개 및 분배하는 역할을 하는 서버이다. WebRTC 기반의 방송과 화상회의형 서비스는 이 미디어 서버가 꼭 필요하다. Janus나 Pion등과 같이 유명한 오픈소스가 존재하여 비교적 쉽게 데모 수준의 서비스를 구현해볼 수 있다.

미디어 서버 덕분에 1:N 이나 N:N 방식의 서비스를 구현할 수는 있지만 문제는 서비스 오픈 이후에 있다. WebRTC 기반 서비스들은 한번 방송에 몇십만 명이 시청하는 서비스보다는 클럽하우스나 아프리카TV 처럼 다수의 방송이 독립적으로 존재하고 적게는 2-4명 많게는 몇천 명이 대화하는 서비스가 주를 이룬다. 따라서 개별 방에 대한 트랜잭션을 미리 예측하거나 대응하기보다는 확장성(Scalability)을 매우 유연하게 제어하고 자동화하는 방식을 고민해야 한다.

### WebRTC 응용 서비스 개발 방법

#### 1. CPaaS를 활용하기

클럽하우스를 비롯한 많은 성공 서비스는 WebRTC 기술과 인프라를 전문적으로 제공하는 CPaaS(Communication Platform as a Service)를 활용하고 있다.

WebRTC 응용 서비스에서 성공을 결정하는 핵심은 WebRTC가 아니라 콘텐츠 자체이기 때문에 핵심에 집중하기 위하여 WebRTC 같은 매우 전문화된 기술은 클라우드 기업에 맡기는 것이다.

#### 2. 직접 WebRTC 서비스 개발에 도전하기

WebRTC 응용 서비스들은 사용자에게 차별화된 경험을 줄 수 있고 일반 서비스보다는 진입하는 데 장벽이 있으므로 욕심 있는 엔지니어라면 한번 도전해 봄직한 분야이다. 만약 WebRTC를 제대로 개발 하려면 최소 5년에서 10년 이상은 단단히 공부 할 각오를 해야 한다. 국내에도 카카오엔터프라이즈를 비롯하여 유수의 기업들이 점점 더 WebRTC의 연구 개발에 뛰어들고 있으며, 아픙로 WebRTC 개발자는 더욱더 많이 필요하게 될 것이다.